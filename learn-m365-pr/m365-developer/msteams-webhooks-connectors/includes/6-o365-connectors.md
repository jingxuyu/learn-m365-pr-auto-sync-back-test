Registered Connectors can be distributed as part of a Microsoft Teams app package. Whether as a standalone solution, or one of several capabilities that your experience enables in Microsoft Teams, you can provide it to users directly for uploading within Microsoft Teams.

Microsoft Teams supports two types of Connectors: incoming webhooks and Office 365 Connectors. In this unit, youâ€™ll learn how to create an Office 365 Connector and add it to Microsoft Teams.

## Office 365 Connectors overview

In a previous unit, you learned how to register an incoming webhook for a Microsoft Teams channel so that your web service could submit messages via an HTTP POST. The other type of Connector supported by Microsoft Teams is an Office 365 Connector. Office 365 Connectors can work with not just Microsoft Teams, but also Outlook.

Incoming webhooks have all the same capabilities and features as Office 365 Connectors, however Office 365 Connectors differ from incoming webhooks in the following ways:

- **Inclusion in AppSource**: Office 365 Connectors can be submitted for validation by Microsoft for inclusion in the AppSource. Installing apps from the native Microsoft Teams experience can simplify the setup steps required for adding a Connector to a channel.
- **Publish to your organization**: If your Office 365 Connector isn't intended to be used by anyone who has access to AppSource, you can publish it to your organization.
- **Custom configuration experience**: When adding an Office 365 Connector to a Microsoft Teams app, the developer can specify a configuration page. This page is presented to the user when they add the Connector to a channel. From this page, the developer can obtain the endpoint and send it to the web service as part of the Connector registration.

    The endpoint is the same URL that is generated by Microsoft Teams when registering an incoming webhook. This differs from incoming webhooks where the person registering the webhook must manually add the endpoint to their web service.

## Add an Office 365 Connector to a Microsoft Teams app

You can distribute your registered Connector as part of your Teams app package. Whether as a standalone solution, or one of several capabilities that your experience enables in Teams, you can package and publish your Connector as part of your AppSource submission, or you can provide it to users directly for uploading within Microsoft Teams.

Start by registering your connector using the [Connectors Developer Dashboard](https://outlook.office.com/connectors/home/login/#/publish).

![Screenshot of registered Connector in the Connectors Developer Dashboard](../media/07-connector-dashboard-02.png)

### Create the configuration experience

Your users will complete the entire Connector configuration experience without leaving the Microsoft Teams client. The configuration experience, implemented as a web page, is displayed within the Microsoft Teams client in an IFRAME.

The configuration page flow works like this:

1. The user selects your Connector to begin the configuration process.
1. Microsoft Teams loads your configuration experience in an IFRAME.
1. The user interacts with your web experience and completes the configuration.
1. The user selects the **Save** button that triggers a callback in your code.
1. Your code processes the save event by retrieving the channel's webhook settings for the Connector and stores the webhook endpoint so it can submit HTTP POST requests to it in the future.

Developers implementing the configuration experience should do the following:

- **Include the Microsoft Teams JavaScript SDK**: Your code will use the SDK to get the current user/channel/team context and (*if necessary*) start authentication flows. Initialize the SDK by calling `microsoftTeams.initialize()`.
- **Call `microsoftTeams.settings.setValidityState(true)` when you want to enable the Save button**: You should do this as a response to valid user input, such as a selection or field update.
- **Register a `microsoftTeams.settings.registerOnSaveHandler()` event handler, called when the user clicks Save**
- **Call `microsoftTeams.settings.setSettings()` to save the connector settings**: You'll save the information that your configuration experience collects from the user. Microsoft Teams keeps a copy of the settings so if the user wants to edit the Connector's configuration in the future, it can prefill the form.
- **Call `microsoftTeams.settings.getSettings()` to fetch webhook properties**: Call this during the save event and when your page is first loaded in the case when a user edits an existing configured Connector.
- **Register a `microsoftTeams.settings.registerOnRemoveHandler()` event handler**: This step is optional, and is only necessary if you support the user from removing the Connector from the channel. It's called when the user removes your Connector by selecting the **Remove** button on the configuration page.

### Editing configured Connectors

Your code should handle users returning to edit an existing connector configuration. To do this, call `microsoftTeams.settings.setSettings()` during the initial configuration.

The call to `setSettings()` is made as part of your `registerOnSaveHandler()` implementation.

### Removing configured Connectors

You can optionally execute an event handler when the user removes an existing Connector configuration. You register this handler by implementing the `microsoftTeams.settings.registerOnRemoveHandler()`  method. This method can be used to do clean up operations such as removing entries from a database.

### Add the Connector to the Microsoft Teams app manifest

The last step to make your Connector available to Microsoft Teams is to include it in the app's manifest. The manifest file shouldn't have any properties for `configurableTabs`, `staticTabs`, `bots`, or `composeExtensions`. If those are present in your app manifest, be sure to remove them.

Define your Connector in the app manifest by adding it to the `connectors` property and include the following properties:

- `connectorId`: the unique ID (GUID) of your Connector obtained from registering it on the Connector Developer Dashboard
- `configurationUrl`: the fully qualified URL where the configuration page is hosted
- `scopes`: set to `team`

```json
"connectors": [
  {
    "connectorId": "{{CONNECTOR_ID}}",
    "configurationUrl": "https://{{HOSTNAME}}/myFirstTeamsConnector/config.html",
    "scopes": [
      "team"
    ]
  }
```

Be sure to include two icons, using the `icons` property in the app manifest, to specify the icons for your Connector.

## Summary

In this unit, you learned how to create an Office 365 Connector and add it to Microsoft Teams.
