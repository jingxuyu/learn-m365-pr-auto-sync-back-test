Exchange uses several anti-spam technologies to minimize incoming spam messages. Exchange scans incoming messages and stores the results in the anti-spam message headers that are part of every SMTP message. It also saves the Spam Confidence Level (SCL) in one of the message headers. The SCL indicates the likeliness the message is spam.

### Anti-spam message headers

When an inbound email message is scanned, the **X-Forefront-Antispam-Report** header is inserted into the message. The fields in this header can help provide administrators with information about the message and about how it was processed, and it contains entries such as the SCL for the message.

The fields in the **X-Microsoft-Antispam** header also provide information about bulk mail and phishing. Besides these two headers, Exchange Online Protection also inserts email authentication results for each message it processes in the **Authentication-results** header.

You can view the headers in a message by using any text editor, such as Notepad or the Message Header Analyzer in the [Microsoft Remote Connectivity Analyzer](https://testconnectivity.microsoft.com/tests/o365?azure-portal=true).

> [!NOTE]
> Text editors such as Notepad only display the raw header. However, the Message Header Analyzer analyzes the raw data and displays it in a more user-friendly format.

The **X-ForeFront-Antispam-Report** message header can contain the following entries:

| **Message field** |                                                                                                                                                        **Description**                                                                                                                                                        |
|:-----------------:|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|
|       CTRY        |                                                                    The region from which the message is connected to the service. This value is determined by the connecting IP address, which may not be the same as the originating sending IP address.                                                                     |
|       LANG        |                                                                                                      The language in which the message was written as specified by the country code (for example, “ru-RU” for Russian).                                                                                                       |
|        SCL        |                                                                                                        The Spam Confidence Level (SCL) value of the message. This value indicates the likeliness the message is spam.                                                                                                         |
|     SRV:BULK      |                 The message was identified as a bulk email message. If the **Block all bulk email messages** advanced spam filtering option is enabled, it will be marked as spam. If it isn't enabled, it will only be marked as spam if the rest of the filtering rules determine that the message is spam.                 |
|        SFE        | Filtering was skipped, and the message was let through because it originated from a safe sender. For more information about safe senders, see the [Safe Sender and Blocked Sender Lists FAQ](/microsoft-365/security/office-365-security/create-safe-sender-lists-in-office-365?azure-portal=true). |
|        BLK        |                                                                                                                Filtering was skipped, and the message was blocked because it originated from a blocked sender.                                                                                                                |
|        SPM        |                                                                                                                                      The message was marked as spam by the spam filter.                                                                                                                                       |
|        SKS        |                                             The message was marked as spam before being processed by the content filter. Messages that are marked as spam include messages that matched a Transport rule that automatically marked them as spam and bypassed all other filtering.                                             |
|       NSPM        |                                                                                                                          The message was marked as non-spam and was sent to the intended recipients.                                                                                                                          |

The **X-Microsoft-Antispam** message header contains the following information about the Bulk Complaint Level (BCL) and the Phishing Confidence Level (PCL):

 -  **Bulk Complaint Level (BCL).** The BCL indicates the likeliness of a message being a bulk email. A BCL of 0 indicates the message isn’t from a bulk sender, while a BCL of 9 indicates the message is from a bulk sender who has generated many complaints.
 -  **Phishing Confidence Level (PCL).** The PCL indicates the likeliness of a message being a phishing message.
    
     -  0-3: The message's content isn't likely to be phishing.
     -  4-8: The message's content is likely to be phishing.
     -  \-9990: (Exchange Online Protection only) The message's content is likely to be phishing.

> [!NOTE]
> The remaining fields in the **X-Microsoft-Antispam** message header are used exclusively by the Microsoft anti-spam team for diagnostic purposes.

### Spam confidence levels (SCL)

As incoming messages go through spam filtering, they're assigned a spam score in the **X-ForeFront-Antispam-Report**. This score maps to an SCL, as recorded in the X-header.

| **SCL Rating** | **Interpretation**                                                          | **Default Action** |
|:--------------:|:--------------------------------------------------------------------------- |:------------------ |
|       -1       | The message comes from the safe sender, safe recipient, or safe IP address. | Deliver to Inbox   |
|      0, 1      | Message scanned and found to be clean.                                      | Deliver to Inbox   |
|      5, 6      | Spam                                                                        | Send to Junk Email |
|       9        | High confidence spam                                                        | Send to Junk Email |

> [!NOTE]
> Exchange Online Protection doesn't use SCL levels 2, 3, 4, 7, and 8.

You can use spam filtering policies to specify what happens with high confidence spam. For example, the message can be deleted rather than being sent to junk mail. You can also set SCL conditions in transport rules.

**Additional reading**. For more information, see [Anti-spam message headers](/microsoft-365/security/office-365-security/anti-spam-message-headers?azure-portal=true) and [Use mail flow rules to set the spam confidence level (SCL) in messages](/exchange/security-and-compliance/mail-flow-rules/use-rules-to-set-scl?azure-portal=true).
